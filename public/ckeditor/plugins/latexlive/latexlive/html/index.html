<!DOCTYPE html>

<html lang="zh-cn">

<head>
  <meta charset="utf-8" />
  <title>在线LaTeX公式编辑器-编辑器</title>
  <meta name="renderer" content="webkit" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta content="always" name="referrer" />
  <meta name="renderer" content="webkit" />
  <meta name="robots" content="all" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0,maximum-scale=1.0, minimum-scale=1.0,user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <script src="../js/common/config.js" id="common_config" data-pagetype="latex"></script>
  <script src="../js/common/common_05.js" id="common_05"></script>
  <script src="../js/common/common_10.js" id="common_10"></script>
</head>

<body>
  <script src="../js/common/common_20.js" id="common_20"></script>

  <!-- #region page -->
  <div class="container-fluid">
    <div class="row-fluid">
      <div class="span12">
        <div class="btn-group">
          <button class="btn" type="button"><em class="icon-align-left"></em></button> <button class="btn"
            type="button"><em class="icon-align-center"></em></button> <button class="btn" type="button"><em
              class="icon-align-right"></em></button> <button class="btn" type="button"><em
              class="icon-align-justify"></em></button>
        </div>
      </div>
    </div>
  </div>
  <section class="flat-container container-fluid~">
    <div class="flat-row row~">
      <div class="flat-col col-xl-6~">
        <div class="container area" id="input-area">
          <div class="card">
            <div class="card-header">
              <h2><i class="fa fa-edit"></i>输入区域<span>Input</span></h2>
              <button class="btn btn-light theme-fill" id="btn_setting"><i class="fa fa-cog"></i>编辑器设置</button>
            </div>
            <div class="card-body">
              <div class="form-group" id="wrap_shortcut"></div>
              <div class="form-group" id="wrap_immediate"></div>
              <div class="form-group" id="wrap_txtainput">
                <textarea class="form-control twins" id="txta_input" placeholder="请输入您的LaTeX表达式" maxlength="16384"
                  spellcheck="false" wrap="off"></textarea>
                <div class="form-control twins" id="div_copy"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="flat-col col-xl-6~">
        <div class="container area" id="output-area">
          <div class="card">
            <div class="card-header">
              <h2><i class="fa fa-arrow-circle-down"></i>&nbsp;输出区域<span>Output</span></h2>
            </div>
            <div class="card-body">
              <div class="form-group">
                <div class="output" id="wrap_output"></div>
              </div>
              <div id="wrap_action"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="screenmodal" id="wrap_setting"></div>
  <div class="screenmodal-mask" id="mask_setting"></div>

  <!-- Modal -->
  <div class="modal fade" id="modal-notify" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><i class="fa fa-exclamation-circle" aria-hidden="true"></i>公告</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p id="p_notify"></p>
        </div>
        <div class="modal-footer">
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="check_noshow">
            <label class="form-check-label" for="check_noshow">不再显示</label>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- #endregion -->
  <script src="../js/common/common_50.js" id="common_50"></script>
  <script>
    function setLatex(code) {
      window.immediate.obj_element.el_input.value = "";
      window.immediate.obj_input.input('', 0)
      window.immediate.obj_input.input(code)
    }

    function saveOK(editor) {
      var latex = window.action.obj_element.el_input.value;
    //   editor && editor.insertHtml && editor.insertHtml(`<span class="math-tex" data-latexlive="${latex}">\\(${latex}\\)</span>`);
        var latexImg = svgBase64()
        editor && editor.insertHtml && editor.insertHtml(`<img src=${latexImg} data-latexlive="${latex}" alt="" />`);
        return true
    }

    function svgBase64() {
        // 找到页面上面的svg元素
        const svg = window.action.obj_output.svgSource;
        // 将整个 document 对象序列化为一个 XML 字符串
        const s = new XMLSerializer().serializeToString(svg);
        // 通过window.btoa() 方法用于创建一个 base-64 编码的字符串
        const img = `data:image/svg+xml;base64,${window.btoa(s)}`;
        // 将转换后的 base64 代码绑定在页面上
        return img
    }
  </script>
</body>

</html>